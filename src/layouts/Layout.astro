---
import Head from '../components/Head.astro';
import SiteHeader from '../components/SiteHeader.vue';
import SiteFooter from '../components/SiteFooter.vue';
import "@fontsource-variable/doto";
import "@fontsource-variable/jetbrains-mono";
import TerminalWindow from '../components/TerminalWindow.vue';
import { getGitBranch, getLatestCommitHash, getLatestCommitMessage, getGitHubRepoUrl } from '../utils/gitInfo.js';
import { isTerminalActive } from '../stores/ui.js';

export interface Props {
    title?: string;
    description?: string;
    favicon?: string;
    headerVariant?: string;
}

const {title, description, favicon, headerVariant = 'default'} = Astro.props;
const gitBranch = await getGitBranch();
const commitHash = await getLatestCommitHash();
const commitMessage = await getLatestCommitMessage();
const repoUrl = getGitHubRepoUrl();
---

<html lang="en">
<Head
    title={title}
    description={description}
    favicon={favicon}
>
  <script>
    // Script to handle body scrolling based on terminal active state
    import { isTerminalActive } from '../stores/ui.js';

    isTerminalActive.listen((active) => {
      if (active) {
        document.body.style.overflow = 'hidden';
      } else {
        document.body.style.overflow = '';
      }
    });
  </script>
</Head>
<body>
<SiteHeader gitBranch={gitBranch} variant={headerVariant} client:only="vue" />
<slot/>
<SiteFooter commitHash={commitHash} commitMessage={commitMessage} repoUrl={repoUrl} client:load />
<TerminalWindow
    client:only="vue"
    title="Nick's Terminal"
    initialOutput={[
        "Welcome to Nick Berens' Terminal",
        "Type 'help' for available commands"
    ]}
/>
</body>
</html>
